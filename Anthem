# ANTHEM â€” TryHackMe (Easy) ğŸ¶ğŸ’€ğŸªŸ

ANTHEM is a Windows-based Easy box that proudly teaches one core lesson:

> **If you hide passwords in robots.txt, attackers donâ€™t need exploits â€” they need eyes.**

No payload crafting.  
No memory corruption.  
Just **criminally bad configuration choices** and oversharing at its finest.

---

## Machine Overview ğŸ–¥ï¸ğŸ“Œ

Target IP: 10.80.142.4  
Operating System: Windows (very likely Windows Server 2019)

This machine revolves around **web-based information disclosure**, which eventually snowballs into **RDP access and full Administrator compromise**.

Basically: the box leaks everythingâ€¦ politely.

---

## Initial Reconnaissance ğŸ”ğŸ‘£

Started with a full TCP scan to see what the target decided to expose to the world.

nmap -sC -sV -oN nmap.txt 10.80.142.4

Open ports discovered:

80/tcp   HTTP   Microsoft HTTPAPI httpd 2.0 ğŸŒ  
3389/tcp RDP    Microsoft Terminal Services ğŸ”‘  

Extra goodies collected for free:

Hostname: WIN-LU09299160F  
OS Guess: Windows Server 2019 (high confidence)  
Product Version: 10.0.17763  
RDP Certificate CN: WIN-LU09299160F  

Only HTTP and RDP exposed â€” which immediately screamed:

ğŸ‘‰ **â€œSteal creds from the website, then walk in through RDP.â€**

---

## Attack Strategy ğŸ§ ğŸ¯

RDP was exposed but locked behind credentials.  
So the plan was simple:

**Abuse the website â†’ steal credentials â†’ RDP â†’ win.**

No detours.  
No overthinking.  
Port 80 became the main character.

---

## Web Enumeration (Port 80) ğŸŒğŸ§

Visiting the site revealed it was running **Umbraco CMS**, a .NET-based CMS commonly found on Windows servers.

Instead of attacking Umbraco itself, the focus shifted to something much easier:

ğŸ‘‰ **Content inspection & misconfigurations**  
(Because developers love leaking secrets in plain sight.)

---

## Information Disclosure via Content ğŸ§¾ğŸš¨

The website was basically playing hide-and-seek with flagsâ€¦ very badly.

What was found:

- Two flags hidden inside HTML meta tags ğŸ·ï¸  
- One flag chilling inside the search bar placeholder ğŸ”  
- One flag embedded directly in page source ğŸ’¬  

At this point, the site had already failed basic hygiene checks.

But it got worse.

---

## robots.txt â€” The Hall of Shame ğŸ¤¡ğŸ“„

Checked robots.txt becauseâ€¦ of course.

And found something beautiful:

ğŸ‘‰ **The admin password. In plaintext.**  

Yes.  
In robots.txt.  
On the internet.

To make things even funnier, a poem on the website revealed:

- The author name = admin username/email  

So now we had:
- Admin username âœ…  
- Admin password âœ…  

Attack difficulty dropped to **zero**.

---

## Initial Access via RDP ğŸ”ğŸ˜

With valid credentials in hand, RDP access was attempted.

xfreerdp3 /u:sg /p:[password] /v:10.80.142.4 /drive:/tmp /cert:ignore +clipboard

Connection result?

âœ… Successful  
âŒ Security  
ğŸ’€ Sysadmin pride  

User-level access achieved.

---

## Post-Exploitation Enumeration ğŸ”ğŸ“‚

After landing on the box, enumeration continued.

During filesystem exploration, a **hidden backup directory** was discovered.

Inside it:

restore.txt ğŸ‘€

Observations:
- Permissions were overly permissive  
- Current user (sg) could modify access controls  

Backup files + bad permissions = incoming disaster.

---

## Privilege Escalation ğŸš€ğŸ”¥

Permissions on restore.txt were modified to allow full access.

Inside the file?

ğŸ‘‰ **Administrator credentials.**  

Because why protect backups, right?

---

## Administrator Access ğŸğŸ‘‘

Using the newly discovered Administrator credentials:

- New RDP session initiated  
- Administrator access confirmed  
- Full system control achieved  

Root flag located and submitted.

Machine status: **Absolutely owned.**

---

## Key Takeaways ğŸ§ ğŸ“Œ

- Exposed RDP is dangerous when credentials are handled like jokes  
- robots.txt is NOT a password manager  
- CMS content can leak far more than intended  
- Backup files with bad permissions are privilege escalation gold  
- No exploits were harmed in the making of this compromise  

---

## Final Words â˜•ğŸ˜Œ

ANTHEM is proof that:

> â€œAttackers donâ€™t always hack â€” sometimes they just read.â€

Clean enumeration.  
Basic curiosity.  
Free admin access.

Easy box.  
Embarrassing mistakes.
