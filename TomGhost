# TomGhost â€” TryHackMe (Easy) ğŸ‘»ğŸ±â€ğŸ‘¤ğŸ”¥

TomGhost is that box where Tomcat decides to become Casper  
and starts **leaking files from the afterlife**.

AJP exposed.  
Ghostcat alive.  
Credentials flying around.  
Sudo doing dumb things.

Clean. Classic. Dangerous.

---

## Machine Overview ğŸ–¥ï¸ğŸ“Œ

Machine Name: TomGhost  
Target IP: 10.10.xxx.xxx  
Operating System: Ubuntu-based Linux  

This machine revolves around **Apache Tomcat misconfiguration**,  
**Ghostcat (CVE-2020-1938)** abuse, **credential harvesting**,  
and a **GTFOBins-certified sudo escalation** to finish strong.

---

## Initial Reconnaissance ğŸ”ğŸ‘€

Started with the usual â€œwhat did you leave open?â€ scan.

nmap -sC -sV 10.10.xxx.xxx

Services discovered:

22/tcp    SSH     OpenSSH 7.2p2 ğŸ”  
53/tcp    DNS     tcpwrapped ğŸŒ  
8009/tcp  AJP     Apache Jserv Protocol 1.3 ğŸ‘»  
8080/tcp  HTTP    Apache Tomcat 9.0.30 ğŸ±  

The moment **AJP (8009)** and **Tomcat (8080)** showed up together,  
the box basically whispered:

ğŸ‘‰ *â€œGhostcat me exploit kar.â€*

---

## Service Analysis ğŸ§ ğŸ”

SSH enumeration was tested briefly:

- Version was old  
- Username enumeration behaved inconsistently  

Conclusion:
ğŸ‘‰ SSH is not the entry point today.

Attention fully shifted to Tomcat.

---

## Tomcat Vulnerability Identification ğŸ‘»ğŸ“š

Tomcat version **9.0.30** is vulnerable to:

ğŸ‘‰ **CVE-2020-1938 â€” Ghostcat**

This vulnerability allows **arbitrary file read** via the AJP connector  
when misconfigured.

Conditions were perfect:
- AJP exposed  
- Tomcat accessible  
- Security expectations low  

Green light.

---

## Exploitation via AJP (Ghostcat) ğŸ‘»ğŸ’£

Abused the AJP connector to read internal files from Tomcat.

And as alwaysâ€¦  
someone left credentials behind.

Leaked credentials:

skyfuck : 8730281lkjlkjdqlksalks  

Straight out of the serverâ€™s soul.

---

## Initial Access via SSH ğŸ”‘ğŸ˜

Tried SSH using the recovered credentials.

Result?

âœ… Login successful  
âœ… User shell obtained  
âœ… user.txt flag captured  

Foothold achieved without brute force or guessing.

---

## Post-Exploitation Enumeration ğŸ”ğŸ§ 

Standard checks followed:

- sudo access âŒ not available  
- SUID binaries âŒ nothing interesting  

But filesystem enumeration never disappoints.

Found something spicy ğŸ‘€

ğŸ‘‰ An **encrypted PGP file**

Which usually means:
â€œthereâ€™s another user hiding somewhere.â€

---

## Lateral Movement ğŸ”„ğŸ§™â€â™‚ï¸

Extracted and cracked the PGP file.

Recovered credentials for another user:

ğŸ‘‰ **merlin**

Switched to the merlin account.

Then ran:

sudo -l

And suddenlyâ€¦ everything changed ğŸ˜ˆ

---

## Privilege Escalation ğŸš€ğŸ”¥

The **zip** binary was allowed to run with sudo privileges.

zip looks harmless.  
zip is not harmless.

Checked GTFOBins.

GTFOBins smiled back ğŸ˜

Using the known technique, zip was abused to execute commands as root.

---

## Root Access ğŸğŸ‘‘

- Root shell obtained  
- Root privileges confirmed  
- root.txt flag captured  

Machine officially exorcised.

---

## Key Takeaways ğŸ§ ğŸ“Œ

- Exposed AJP connectors are extremely dangerous  
- Ghostcat is a reminder that configs matter more than patches  
- Credentials leak faster than people expect  
- Encrypted files often enable lateral movement  
- â€œSafeâ€ binaries become deadly with sudo  

---

## ğŸ“¬ Contact & Projects ğŸ‘¨â€ğŸ’»ğŸ“

**Daksh Baweja**  
ğŸ“§ Email: dakshbaweja20@gmail.com  
ğŸ™ GitHub: https://github.com/sudo0xksh  
ğŸ”— LinkedIn: https://www.linkedin.com/in/dakshbaweja  

---

## ğŸš€ Deteroid ğŸ”¥

**Deteroid** is a dedicated review platform for bug bounty hunters to  
share insights, rate programs, and collaborate on real-world security findings.

Empowering ethical hackers with **community-driven intel**  
to hunt smarter, not harder.

ğŸ“¸ Instagram: https://www.instagram.com/deteroids/

---

## Final Words â˜•ğŸ˜Œ

TomGhost proves one timeless lesson:

> â€œIf AJP is exposed, Tomcat will haunt you.â€

Clean enumeration.  
One good CVE.  
Free root.

Easy box.  
Very real mistakes.
